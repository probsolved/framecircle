<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h4 mb-1">Your Groups</h1>
    <div class="text-muted">Mini-groups you belong to</div>
  </div>

  <%= link_to "New Group", new_group_path, class: "btn btn-primary" %>
</div>

<div class="row g-3">
  <% @groups.each do |group| %>
  <% membership = GroupMembership.find_by(group: group, user: current_user) %>
  <% is_admin = group.owner_id == current_user.id || membership&.role.to_s == "admin" %>

  <div class="col-12 col-md-6 col-lg-4">
    <div class="card glass-card h-100 p-3 d-flex flex-column justify-content-between">
      <div>
        <!-- Group name + visibility pill -->
        <div class="d-flex align-items-center gap-2 mb-1">
          <h5 class="group-title mb-0"><%= group.name %></h5>

          <% if group.public? %>
          <span class="badge rounded-pill text-bg-success">Public</span>
          <% else %>
          <span class="badge rounded-pill text-bg-secondary">Private</span>
          <% end %>
        </div>

        <div class="small text-muted">
          <%= pluralize(group.members.count, "member") %>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mt-3">
        <%= link_to "Open", group_path(group), class: "btn btn-sm btn-outline-secondary" %>

        <% if is_admin %>
        <%= link_to "Manage",
                  group_manage_path(group),
                  class: "btn btn-sm btn-outline-primary" %>
        <% end %>
      </div>
    </div>
  </div>
  <% end %>

  <% if @groups.empty? %>
  <div class="col-12">
    <div class="card glass-card p-4 text-center">
      <div class="h5 mb-2">No groups yet</div>
      <div class="text-muted mb-3">
        Create a group to start a weekly photo critique circle.
      </div>
      <%= link_to "Create your first group", new_group_path, class: "btn btn-primary" %>
    </div>
  </div>
  <% end %>
</div>